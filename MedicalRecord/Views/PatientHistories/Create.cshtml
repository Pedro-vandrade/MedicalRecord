@model MedicalRecord.Models.PatientHistory

@{
    ViewData["Title"] = "Create";
}

<h1>Create</h1>

<h4>PatientHistory</h4>
<hr />
<div class="row">
    <div class="col-md-4">
        <form asp-action="Create">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>

            <div class="form-group">
                <label asp-for="PatientId" class="control-label"></label>
                <select asp-for="PatientId" class="form-control" asp-items="ViewBag.PatientId"></select>
            </div>

            <div class="form-group">
                <label asp-for="BloodType" class="control-label"></label>
                <select asp-for="BloodType"
                        class="form-control"
                        asp-items="@(new SelectList(ViewBag.BloodTypes))">
                    <option value=""> - Select Blood Type - </option>
                </select>
                <span asp-validation-for="BloodType" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label class="control-label">Known Conditions and Diseases</label>

                <div class="border p-3" style="max-height: 200px; overflow-y: auto;">
                    @* Loop through the list of Enums passed in ViewBag.Diseases (must be the full list of Enum values) *@
                    @foreach (var condition in ViewBag.Diseases)
                    {
                        <div class="form-check">
                            @* 🛑 CRITICAL: The 'name' attribute MUST match the List property in your ViewModel (e.g., SelectedConditions) *@
                            <input type="checkbox"
                                   class="form-check-input"
                                   name="SelectedConditions"
                                   value="@condition.ToString()"
                                   id="@($"Condition_{condition}")" />
                            <label class="form-check-label" for="@($"Condition_{condition}")">
                                @condition.ToString()
                            </label>
                        </div>
                    }
                </div>
                @* Bind the validation to the list property in the ViewModel *@
                <span asp-validation-for="KnownConditionsAndDiseases" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label class="control-label">Surgical Procedures</label>

                <div class="border p-3" style="max-height: 200px; overflow-y: auto;">
                    @* Loop through the list of Enums passed in ViewBag.Surgeries *@
                    @foreach (var surgery in ViewBag.Surgeries)
                    {
                        <div class="form-check">
                            @* Binds to the List<string> property in the ViewModel *@
                            <input type="checkbox"
                                   class="form-check-input"
                                   name="SelectedSurgeries"
                                   value="@surgery.ToString()"
                                   id="@($"Surgery_{surgery}")" />
                            <label class="form-check-label" for="@($"Surgery_{surgery}")">
                                @surgery.ToString()
                            </label>
                        </div>
                    }
                </div>
                <span asp-validation-for="SurgicalHistory" class="text-danger"></span>
            </div>

            


            @*Exercicios Realizados *@
            <div class="form-group">
                <label class="control-label">Primary Exercise Activities</label>

                <div class="border p-3" style="max-height: 150px; overflow-y: auto;">
                    @foreach (var activity in ViewBag.ExerciseActivityEnum)
                    {
                        <div class="form-check">
                            @* Binds to the List<string> property in the ViewModel *@
                            <input type="checkbox"
                                   class="form-check-input"
                                   name="SelectedActivities"
                                   value="@activity.ToString()"
                                   id="@($"Activity_{activity}")" />
                            <label class="form-check-label" for="@($"Activity_{activity}")">
                                @activity.ToString()
                            </label>
                        </div>
                    }
                </div>
                <span asp-validation-for="ExerciseActivity" class="text-danger"></span>
            </div>

            @*Frequencia Exercicios *@
            <div class="form-group">
                <label asp-for="ExerciseFrequency" class="control-label"></label>
                <select asp-for="ExerciseFrequency"
                        class="form-control"
                        asp-items="@(new SelectList(ViewBag.ExerciseFrequencyEnum))">
                    <option value="">-- Select Exercise Frequency --</option>
                </select>
                <span asp-validation-for="ExerciseFrequency" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="Smoker" class="control-label"></label>
                <select asp-for="Smoker"
                        class="form-control"
                        asp-items="@(new SelectList(ViewBag.SmokingStatusEnum))">
                    <option value="">-- Smoking Habits --</option>
                </select>
                <span asp-validation-for="Smoker" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="AlcoholConsumption" class="control-label"></label>
                <select asp-for="AlcoholConsumption"
                        class="form-control"
                        asp-items="@(new SelectList(ViewBag.AlcoholConsumptionEnum))">
                    <option value="">-- Select Alcohol Consumption --</option>
                </select>
                <span asp-validation-for="AlcoholConsumption" class="text-danger"></span>
            </div>

            <div class="form-group">
                <input type="submit" value="Create" class="btn btn-primary" />
            </div>
        </form>
    </div>
</div>

<div>
    <a asp-action="Index">Back to List</a>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}